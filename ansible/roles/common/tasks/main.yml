---
- name: Update apt cache
  apt:
    update_cache: yes
  tags: update

- name: Check if ntp is installed
  apt:
    name: ntp
    state: present
  tags: ntp

- name: Check if ntp is configured
  template:
    src: ntp.conf.j2
    dest: /etc/ntp.conf
  notify: 
    - restart ntp
  tags: ntp

- name: Ensure ntp is running
  service:
    name: ntp
    state: started
    enabled: yes
  tags: ntp

- name: Install common packages
  apt:
    name: "{{ packages }}"
  vars:
    packages:
    - vim
    - byobu
    - htop
    - neofetch
    - wget
  tags: common_packages

- name: Copy neofetch.sh to remote
  ansible.builtin.copy:
    src: neofetch.sh
    dest: /etc/profile.d/
    owner: root
    mode: '0644'